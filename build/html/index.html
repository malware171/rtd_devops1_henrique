<!DOCTYPE html>
<html class="writer-html5" lang="pt" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Guia para subir aplicação CRUD contêinerizada! &mdash; Documentação rtd_devops_henrique </title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=103ffe9a"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/translations.js?v=3b002d5c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Índice" href="genindex.html" />
    <link rel="search" title="Pesquisar" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="#" class="icon icon-home">
            rtd_devops_henrique
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Pesquisar docs" aria-label="Pesquisar docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Menu de navegação">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Guia para subir aplicação CRUD contêinerizada!</a></li>
<li><a class="reference internal" href="#passo-1-instalacao-do-multipass">Passo 1: Instalação do Multipass</a><ul>
<li><a class="reference internal" href="#atualizacao-de-dependencias">Atualização de dependências</a></li>
<li><a class="reference internal" href="#download-do-multipass">Download do Multipass</a></li>
</ul>
</li>
<li><a class="reference internal" href="#passo-2-criacao-da-vm">Passo 2: Criação da VM</a><ul>
<li><a class="reference internal" href="#maquina-virtual-de-desenvolvimento">Máquina virtual de desenvolvimento</a></li>
<li><a class="reference internal" href="#acesso-a-maquina-virtual">Acesso à máquina virtual</a></li>
</ul>
</li>
<li><a class="reference internal" href="#passo-3-download-da-aplicacao">Passo 3: Download da aplicação</a></li>
<li><a class="reference internal" href="#passo-4-criacao-dos-containers">Passo 4: Criação dos containers</a><ul>
<li><a class="reference internal" href="#container-banco-de-dados">Container banco de dados</a><ul>
<li><a class="reference internal" href="#acesso-ao-container-banco-de-dados">Acesso ao container banco de dados</a></li>
</ul>
</li>
<li><a class="reference internal" href="#container-servidor-web">Container servidor web</a><ul>
<li><a class="reference internal" href="#instalar-e-habilitar-o-mysql-pdo">Instalar e habilitar o MySQL PDO</a></li>
<li><a class="reference internal" href="#configurando-o-dominio">Configurando o domínio</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#configurando-o-hosts">Configurando o hosts</a></li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Menu de navegação móvel" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">rtd_devops_henrique</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Navegação da página">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Guia para subir aplicação CRUD contêinerizada!</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/index.rst.txt" rel="nofollow"> Ver código-fonte da página</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="guia-para-subir-aplicacao-crud-conteinerizada">
<h1>Guia para subir aplicação CRUD contêinerizada!<a class="headerlink" href="#guia-para-subir-aplicacao-crud-conteinerizada" title="Link to this heading"></a></h1>
<p>Este guia passo a passo o ajudará a configurar e executar uma aplicação CRUD em um ambiente contêinerizado, utilizando Multipass para criar uma máquina virtual e Docker para gerenciar os contêineres.</p>
</section>
<section id="passo-1-instalacao-do-multipass">
<h1>Passo 1: Instalação do Multipass<a class="headerlink" href="#passo-1-instalacao-do-multipass" title="Link to this heading"></a></h1>
<section id="atualizacao-de-dependencias">
<h2>Atualização de dependências<a class="headerlink" href="#atualizacao-de-dependencias" title="Link to this heading"></a></h2>
<p>Antes de instalar o Multipass, é importante garantir que todas as dependências do seu sistema estejam atualizadas:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>$ sudo apt update &amp;&amp; sudo apt upgrade
</pre></div>
</div>
</section>
<section id="download-do-multipass">
<h2>Download do Multipass<a class="headerlink" href="#download-do-multipass" title="Link to this heading"></a></h2>
<p>Segue o link do site oficial do Multipass para a instalação do mesmo:</p>
<p><a class="reference external" href="https://multipass.run/install">Download Multipass</a></p>
<p>Após a instalação concluída, siga para o passo 2.</p>
</section>
</section>
<section id="passo-2-criacao-da-vm">
<h1>Passo 2: Criação da VM<a class="headerlink" href="#passo-2-criacao-da-vm" title="Link to this heading"></a></h1>
<section id="maquina-virtual-de-desenvolvimento">
<h2>Máquina virtual de desenvolvimento<a class="headerlink" href="#maquina-virtual-de-desenvolvimento" title="Link to this heading"></a></h2>
<p>Crie uma máquina virtual para testes antes de executar em seu ambiente de produção.</p>
<p>Para criar sua máquina virtual, utilize o comando:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>$ multipass launch -n servDev docker
</pre></div>
</div>
<p>Para a criação, estaremos utilizando a imagem <code class="docutils literal notranslate"><span class="pre">docker</span></code> para que já venha configurado o Docker. O comando <code class="docutils literal notranslate"><span class="pre">-n</span></code> serve para definir um nome para a máquina virtual. Caso queira mudar, apenas digite <code class="docutils literal notranslate"><span class="pre">multipass</span> <span class="pre">launch</span> <span class="pre">-n</span> <span class="pre">nome-da-maquina-virtual</span> <span class="pre">docker</span></code>.</p>
</section>
<section id="acesso-a-maquina-virtual">
<h2>Acesso à máquina virtual<a class="headerlink" href="#acesso-a-maquina-virtual" title="Link to this heading"></a></h2>
<p>Utilize o comando:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>$ multipass shell servDev
</pre></div>
</div>
<p>O comando <code class="docutils literal notranslate"><span class="pre">multipass</span> <span class="pre">shell</span></code> é utilizado para acessar a máquina virtual.</p>
<p>Atualize os pacotes e dependências da sua máquina virtual:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>$ sudo apt update &amp;&amp; sudo apt upgrade
</pre></div>
</div>
</section>
</section>
<section id="passo-3-download-da-aplicacao">
<h1>Passo 3: Download da aplicação<a class="headerlink" href="#passo-3-download-da-aplicacao" title="Link to this heading"></a></h1>
<p>Antes de fazer o download, verifique se você está dentro da máquina virtual. Após verificar, digite o comando:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>$ git clone https://web:glpat-zyZUFmz1h5J_zyMg9Z2D@gitlab.com/henrique_corp/projetocrud
</pre></div>
</div>
<p>Verifique se a pasta foi baixada com o comando <code class="docutils literal notranslate"><span class="pre">ls</span></code>.</p>
</section>
<section id="passo-4-criacao-dos-containers">
<h1>Passo 4: Criação dos containers<a class="headerlink" href="#passo-4-criacao-dos-containers" title="Link to this heading"></a></h1>
<section id="container-banco-de-dados">
<h2>Container banco de dados<a class="headerlink" href="#container-banco-de-dados" title="Link to this heading"></a></h2>
<p>Para executar o container, utilize o seguinte comando:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>$ docker container run -d -e MYSQL_ROOT_PASSWORD=suasenha --name bancoDeDados -v ./projetocrud/cruddb.sql:/docker-entrypoint-initdb.d/cruddb.sql mysql:8.0-debian
</pre></div>
</div>
<p>Lembre-se de substituir a senha em <code class="docutils literal notranslate"><span class="pre">MYSQL_ROOT_PASSWORD=suasenha</span></code> por uma senha forte.</p>
<p>Verifique se o container está rodando com o comando <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">container</span> <span class="pre">ls</span></code>.</p>
<p>Agora, execute este comando:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>$ docker container inspect bancoDeDados | egrep IPAddress
</pre></div>
</div>
<p>Com este comando, você vai anotar o <code class="docutils literal notranslate"><span class="pre">IPAddress</span></code>.</p>
<p>Agora precisamos mudar o arquivo <code class="docutils literal notranslate"><span class="pre">functions.php</span></code>. Para isso, digite:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>$ sudo nano projetocrud/functions.php
</pre></div>
</div>
<p>Dentro do arquivo <code class="docutils literal notranslate"><span class="pre">functions.php</span></code>, altere os dados:</p>
<section id="acesso-ao-container-banco-de-dados">
<h3>Acesso ao container banco de dados<a class="headerlink" href="#acesso-ao-container-banco-de-dados" title="Link to this heading"></a></h3>
<p>Para acessar o container quando necessário, digite o seguinte comando:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>$ docker container exec -it bancoDeDados bash
</pre></div>
</div>
<p>Para sair do container, digite o comando <code class="docutils literal notranslate"><span class="pre">exit</span></code></p>
</section>
</section>
<section id="container-servidor-web">
<h2>Container servidor web<a class="headerlink" href="#container-servidor-web" title="Link to this heading"></a></h2>
<p>Para começar a configurar o container do servidor web, é necessário estar dentro da máquina virtual <code class="docutils literal notranslate"><span class="pre">servDev</span></code>. Certifique-se de que o nome do terminal esteja <code class="docutils literal notranslate"><span class="pre">ubuntu&#64;servDev:~$</span></code>.</p>
<p>Rode o comando abaixo:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>$ cp /etc/hosts /etc/host-modificated
</pre></div>
</div>
<p>Com este comando, você está fazendo uma cópia do seu <code class="docutils literal notranslate"><span class="pre">/etc/hosts</span></code> para a sua máquina virtual para fazer as modificações necessárias.</p>
<p>Agora vamos subir o container utilizando o comando:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>$ docker run -d --name servidorWeb -p 80:80 -v /etc/host-modificated:/etc/hosts -v ./projetocrud:/var/www/techarper/ php:8.1-apache
</pre></div>
</div>
<section id="instalar-e-habilitar-o-mysql-pdo">
<h3>Instalar e habilitar o MySQL PDO<a class="headerlink" href="#instalar-e-habilitar-o-mysql-pdo" title="Link to this heading"></a></h3>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>$ docker container exec servidorWeb docker-php-ext-install pdo_mysql
</pre></div>
</div>
<p>Agora reinicie o seu container do servidor web:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>$ docker container restart servidorWeb
</pre></div>
</div>
</section>
<section id="configurando-o-dominio">
<h3>Configurando o domínio<a class="headerlink" href="#configurando-o-dominio" title="Link to this heading"></a></h3>
<p>Entre dentro do container do servidorWeb:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>$ docker container exec -it servidorWeb bash
</pre></div>
</div>
<p>Instale as dependências e o nano:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>$ apt update &amp;&amp; apt upgrade
</pre></div>
</div>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>$ apt install nano
</pre></div>
</div>
<p>Agora vamos configurar o Apache:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>$ nano /etc/apache2/sites-available/000-default.conf
</pre></div>
</div>
<p>Agora edite o arquivo e o deixe com as seguintes informações:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>ServerName www.techarper.com
ServerAlias www.techarper.com techarper.com
ServerAdmin henrique@techarper.com
DocumentRoot /var/www/techarper
</pre></div>
</div>
<p>Agora salve com o comando <code class="docutils literal notranslate"><span class="pre">Ctrl</span> <span class="pre">+</span> <span class="pre">O</span></code> e saia do nano com <code class="docutils literal notranslate"><span class="pre">Ctrl</span> <span class="pre">+</span> <span class="pre">X</span></code>.</p>
<p>Após fazer as alterações, saia do container do servidorWeb com <code class="docutils literal notranslate"><span class="pre">exit</span></code>.</p>
</section>
</section>
</section>
<section id="configurando-o-hosts">
<h1>Configurando o hosts<a class="headerlink" href="#configurando-o-hosts" title="Link to this heading"></a></h1>
<p>Agora, na sua máquina virtual <code class="docutils literal notranslate"><span class="pre">servDev</span></code>, edite o <code class="docutils literal notranslate"><span class="pre">/etc/hosts-modificated</span></code> para configurar o DNS.</p>
<p>Primeiro, obtenha o IP da sua máquina virtual com o seguinte comando:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>$ ip -4 -br -c a
</pre></div>
</div>
<p>Vai aparecer algo semelhante a isso:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>lo               UNKNOWN        127.0.0.1/8
ens3             UP             10.119.137.190/24 metric 100
</pre></div>
</div>
<p>Anote o IP de <code class="docutils literal notranslate"><span class="pre">ens3</span></code> para editar dentro do seu <code class="docutils literal notranslate"><span class="pre">/etc/hosts-modificated</span></code>.</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>$ nano /etc/hosts-modificated
</pre></div>
</div>
<p>Seu arquivo vai estar da seguinte forma:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>127.0.1.1 servDev servDev
127.0.0.1 localhost

# The following lines are desirable for IPv6 capable hosts
::1 localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
</pre></div>
</div>
<p>Adicione mais duas linhas com seu IP da máquina virtual e seu nome de domínio configurado dentro do Apache.</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>127.0.1.1 servDev servDev
127.0.0.1 localhost

10.119.137.190   techarper.com
10.119.137.190   www.techarper.com

# The following lines are desirable for IPv6 capable hosts
::1 localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
</pre></div>
</div>
<p>Após configurar o arquivo hosts, reinicie o contêiner do servidor web:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>$ docker container restart servidorWeb
</pre></div>
</div>
<p>Agora você pode tentar acessar o domínio configurado (www.techarper.com) para verificar se a aplicação está funcionando corretamente.</p>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Mauro Henrique Gebara Kachutski.</p>
  </div>

  Compilado com <a href="https://www.sphinx-doc.org/">Sphinx</a> usando um
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">tema</a>
    fornecido por <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>